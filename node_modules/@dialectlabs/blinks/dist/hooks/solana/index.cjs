"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }// src/hooks/solana/useActionSolanaWalletAdapter.ts
var _blinkscore = require('@dialectlabs/blinks-core');
var _walletadapterreact = require('@solana/wallet-adapter-react');
var _walletadapterreactui = require('@solana/wallet-adapter-react-ui');
var _web3js = require('@solana/web3.js');
var _react = require('react');
function useActionSolanaWalletAdapter(rpcUrlOrConnection) {
  const wallet = _walletadapterreact.useWallet.call(void 0, );
  const walletModal = _walletadapterreactui.useWalletModal.call(void 0, );
  const finalConnection = _react.useMemo.call(void 0, () => {
    return typeof rpcUrlOrConnection === "string" ? new (0, _web3js.Connection)(rpcUrlOrConnection, "confirmed") : rpcUrlOrConnection;
  }, [rpcUrlOrConnection]);
  const adapter = _react.useMemo.call(void 0, () => {
    return new (0, _blinkscore.ActionConfig)(finalConnection, {
      connect: async () => {
        try {
          await wallet.connect();
        } catch (e) {
          walletModal.setVisible(true);
          return null;
        }
        return _nullishCoalesce(_optionalChain([wallet, 'access', _ => _.publicKey, 'optionalAccess', _2 => _2.toBase58, 'call', _3 => _3()]), () => ( null));
      },
      signTransaction: async (txData) => {
        try {
          const tx = await wallet.sendTransaction(
            _web3js.VersionedTransaction.deserialize(Buffer.from(txData, "base64")),
            finalConnection
          );
          return { signature: tx };
        } catch (e2) {
          return { error: "Signing failed." };
        }
      }
    });
  }, [finalConnection, wallet, walletModal]);
  return { adapter };
}


exports.useActionSolanaWalletAdapter = useActionSolanaWalletAdapter;
